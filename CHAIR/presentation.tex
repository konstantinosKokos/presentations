\documentclass[aspectratio=169]{beamer}
\usetheme{A}


% -- packages
\usepackage{transparent}
\usepackage{fontspec}
\usepackage{libertinus-otf}
\usepackage{etoolbox}
\usepackage{enumitem}
\usepackage{graphicx}
\usepackage{emoji}
\usepackage{relsize}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,  % Change link color to blue
    urlcolor=blue    % Change URL color to blue
}
\usepackage{booktabs}
\usepackage{tikz}
\usepackage{pgfplots}
\usetikzlibrary{decorations.pathmorphing,calc,fit,scopes,shapes,positioning}
\usepackage{tikz-qtree}
\usepackage{amsmath}
\usepackage{proof}
\usepackage{adjustbox}
\usepackage{eqparbox}
\usepackage{soul}
\usepackage{tabularx}
\usepackage{emoji}

% -- options 
\setbeamercovered{transparent=20}
\setlist[itemize]{label=\textcolor{pred}{$\bullet$}, topsep=0pt, itemsep=0pt}
\setlist[itemize,2]{label=\textcolor{pred}{$\circ$}, topsep=0pt, itemsep=0pt,leftmargin=1.5em}

\newcommand{\light}[1]{\textcolor{light}{#1}}
\definecolor{light}{rgb}{0.35,0.35,0.35}
\definecolor{red}{HTML}{D20000}
\definecolor{blue}{HTML}{0000CD}
\definecolor{green}{HTML}{007100}
\newcounter{tokencounter}
\newcommand{\token}[1]{%
  \stepcounter{tokencounter}%
  \pgfmathsetmacro{\opacity}{1 - \thetokencounter / 180}%
  \ifdim \opacity pt < 0pt
    \def\opacity{0}
  \fi
  \transparent{\opacity}{\fcolorbox{gray}{white}{\textcolor{black!70}{\strut{\detokenize{#1}}}}}%
}
\newcounter{remarkcounter}
\newcommand{\remark}[1]{%
	\begin{flushright}
	#1	
	\end{flushright}
	\stepcounter{remarkcounter}%
}
\newcommand{\overlaytext}[3]{%
  \tikz[remember picture, overlay]{%
    \node[anchor=base] at (#1,#2) {#3};%
  }%
}
\newcommand{\hole}[2]{\alt<{#1}>{\AgdaHole{\smaller ?}}{#2}}
\newcommand{\stdlib}{\texttt{stdlib}}
\newcommand\unimath{\texttt{Unimath}}
\newcommand\typetopo{\texttt{TypeTopo}}
\newcommand\agdaQuill{\textsc{Quill}}	


\title{LLM-free Representation Learning of Theorem Structures\\
\smaller (an application in Agda)
}
\date{%
	\vspace{-2em}\\
	Deep-Learning Models for Mathematics and Type Theory\\
	April 2025, Gothenburg
	\vspace{6em}
}
\author{\light{Konstantinos Kogkalidis}}

\newcommand{\agdafont}{\scriptsize}
\newcommand{\sstat}[2]{\hphantom{1}\ensuremath{#1}}
\newcommand{\bstat}[2]{\ensuremath{#1}}
\newcommand{\bfstat}[2]{\ensuremath{\mathbf{#1}}}
%%%%%%%%%%
% Minted %
%%%%%%%%%%
\usepackage{minted}

%%%%%%%%
% Agda %
%%%%%%%%
\usepackage[conor]{agda}
\AtBeginEnvironment{code}{\agdafont}
\usepackage{newunicodechar}
\newunicodechar{ℕ}{\ensuremath{\mathbb{N}}}
\newunicodechar{λ}{\ensuremath{\mathnormal\lambda}}
\newunicodechar{→}{\ensuremath{\mathnormal\to}}
\newunicodechar{∀}{\ensuremath{\mathnormal\forall}}
\newunicodechar{≡}{\ensuremath{\mathnormal\equiv}}
\newunicodechar{⋯}{\ensuremath{\mathnormal\dots}}
\newcommand\AD[1]{\AgdaDatatype{\agdaFontSize#1}}
\newcommand\AF[1]{\AgdaFunction{\agdaFontSize#1}}
\newcommand\AS[1]{\AgdaSymbol{\agdaFontSize#1}}
\newcommand\AB[1]{\AgdaBound{\agdaFontSize#1}}
\newcommand\AK[1]{\AgdaKeyword{\agdaFontSize#1}}
\usepackage{lipsum}

\begin{document}


\maketitle

\begin{frame}{}
	\smaller
	\vspace{6em}
	\textbf{Based on}:\\
	K. Kogkalidis, O. Melkonian, and J.-P. Bernardy. \textit{Learning structure-aware representations of
dependent types}. NeurIPS, 2024.

	\vspace{2em}
	\textbf{\emoji{euro} from}:\\
	EuroProofNet CA2011 WG5 (2 STSMs @ GU, 2023).
	
	\vspace{8em}
	\begin{flushright}
	\includegraphics[height=0.085\textwidth]{cost.pdf}\hspace{1.5em}
	\raisebox{0.475em}{\includegraphics[height=0.06\textwidth]{eu.png}}
	\end{flushright}
\end{frame}

\begin{frame}{Context}
	\smaller
	...
\end{frame}

\begin{frame}[fragile, plain]{\alt<2->{... what Agda shows you}{Proving stuff (in Agda): what you write}}
	\smaller
	\only<1>{		
	    % Aspect colours.
	    \definecolor{AgdaComment}      {HTML}{000000}
	    \definecolor{AgdaPragma}       {HTML}{000000}
	    \definecolor{AgdaKeyword}      {HTML}{000000}
	    \definecolor{AgdaString}       {HTML}{000000}
	    \definecolor{AgdaNumber}       {HTML}{000000}
	    \definecolor{AgdaSymbol}       {HTML}{000000}
	    \definecolor{AgdaPrimitiveType}{HTML}{000000}
	
	    % NameKind colours.
	    \definecolor{AgdaBound}                 {HTML}{000000}
	    \definecolor{AgdaGeneralizable}         {HTML}{000000}
	    \definecolor{AgdaInductiveConstructor}  {HTML}{000000}
	    \definecolor{AgdaCoinductiveConstructor}{HTML}{000000}
	    \definecolor{AgdaDatatype}              {HTML}{000000}
	    \definecolor{AgdaField}                 {HTML}{000000}
	    \definecolor{AgdaFunction}              {HTML}{000000}
	    \definecolor{AgdaMacro}                 {HTML}{000000}
	    \definecolor{AgdaModule}                {HTML}{000000}
	    \definecolor{AgdaPostulate}             {HTML}{000000}
	    \definecolor{AgdaPrimitive}             {HTML}{000000}
	    \definecolor{AgdaRecord}                {HTML}{000000}
	    \definecolor{AgdaArgument}              {HTML}{000000}
	
	    % Other aspect colours.
	    \definecolor{AgdaDottedPattern}     {HTML}{000000}
	    \definecolor{AgdaUnsolvedMeta}      {HTML}{D3D3D3}
	    \definecolor{AgdaUnsolvedConstraint}{HTML}{D3D3D3}
	    \definecolor{AgdaTerminationProblem}{HTML}{BEBEBE}
	    \definecolor{AgdaIncompletePattern} {HTML}{D3D3D3}
	    \definecolor{AgdaErrorWarning}      {HTML}{BEBEBE}
	    \definecolor{AgdaError}             {HTML}{696969}
	
	    % Misc.
	    \definecolor{AgdaHole}              {HTML}{BEBEBE}
	}
	\begin{minipage}{0.9\textwidth}
	\begin{code}%
	\>[0]\AgdaKeyword{open}\AgdaSpace{}%
	\AgdaKeyword{import}\AgdaSpace{}%
	\AgdaModule{Relation.Binary.PropositionalEquality}\AgdaSpace{}%
	\AgdaKeyword{using}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\AgdaSymbol{;}\AgdaSpace{}%
	\AgdaInductiveConstructor{refl}\AgdaSymbol{;}\AgdaSpace{}%
	\AgdaFunction{cong}\AgdaSymbol{;}\AgdaSpace{}%
	\AgdaFunction{trans}\AgdaSymbol{)}\<%
	\end{code}
	
	\vspace{-1.25em}
	\begin{minipage}{.3\linewidth}
	\begin{code}%
	\>[0]\AgdaKeyword{data}\AgdaSpace{}%
	\AgdaDatatype{ℕ}\AgdaSpace{}%
	\AgdaSymbol{:}\AgdaSpace{}%
	\AgdaPrimitive{Set}\AgdaSpace{}%
	\AgdaKeyword{where}\<%
	\\
	\>[0][@{}l@{\AgdaIndent{0}}]%
	\>[2]\AgdaInductiveConstructor{zero}%
	\>[8]\AgdaSymbol{:}\AgdaSpace{}%
	\AgdaDatatype{ℕ}\<%
	\\
	%
	\>[2]\AgdaInductiveConstructor{suc}%
	\>[8]\AgdaSymbol{:}\AgdaSpace{}%
	\AgdaDatatype{ℕ}\AgdaSpace{}%
	\AgdaSymbol{→}\AgdaSpace{}%
	\AgdaDatatype{ℕ}\<%
	\end{code}
	\end{minipage}
	
	\vspace{-1.25em}
	\begin{minipage}{.5\linewidth}
	\begin{code}%
	\>[0]\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}+\AgdaUnderscore{}}}\AgdaSpace{}%
	\AgdaSymbol{:}\AgdaSpace{}%
	\AgdaDatatype{ℕ}\AgdaSpace{}%
	\AgdaSymbol{→}\AgdaSpace{}%
	\AgdaDatatype{ℕ}\AgdaSpace{}%
	\AgdaSymbol{→}\AgdaSpace{}%
	\AgdaDatatype{ℕ}\<%
	\\
	\>[0]\AgdaInductiveConstructor{zero}%
	\>[7]\AgdaOperator{\AgdaFunction{+}}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSpace{}%
	\AgdaSymbol{=}\AgdaSpace{}%
	\AgdaBound{n}\<%
	\\
	\>[0]\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaBound{m}%
	\>[7]\AgdaOperator{\AgdaFunction{+}}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSpace{}%
	\AgdaSymbol{=}\AgdaSpace{}%
	\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
	\AgdaOperator{\AgdaFunction{+}}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSymbol{)}\<%
	\end{code}
	\end{minipage}
	
	\vspace{-1.25em}
	\begin{code}%
	\>[0]\AgdaFunction{+-comm}\AgdaSpace{}%
	\AgdaSymbol{:}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSpace{}%
	\AgdaSymbol{:}\AgdaSpace{}%
	\AgdaDatatype{ℕ}\AgdaSymbol{)}\AgdaSpace{}%
	\AgdaSymbol{→}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSpace{}%
	\AgdaOperator{\AgdaFunction{+}}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSpace{}%
	\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSpace{}%
	\AgdaOperator{\AgdaFunction{+}}\AgdaSpace{}%
	\AgdaBound{m}\<%
	\\
	\>[0]\AgdaFunction{+-comm}\AgdaSpace{}%
	\AgdaInductiveConstructor{zero}%
	\>[16]\AgdaInductiveConstructor{zero}%
	\>[25]\AgdaSymbol{=}\AgdaSpace{}%
	\AgdaInductiveConstructor{refl}\<%
	\\
	\>[0]\AgdaFunction{+-comm}\AgdaSpace{}%
	\AgdaInductiveConstructor{zero}%
	\>[16]\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSymbol{)}%
	\>[25]\AgdaSymbol{=}\AgdaSpace{}%
	\AgdaFunction{cong}\AgdaSpace{}%
	\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaFunction{+-comm}\AgdaSpace{}%
	\AgdaInductiveConstructor{zero}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSymbol{)}\<%
	\\
	\>[0]\AgdaFunction{+-comm}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSymbol{)}%
	\>[16]\AgdaInductiveConstructor{zero}%
	\>[25]\AgdaSymbol{=}\AgdaSpace{}%
	\AgdaFunction{cong}\AgdaSpace{}%
	\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaFunction{+-comm}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSpace{}%
	\AgdaInductiveConstructor{zero}\AgdaSymbol{)}\<%
	\\
	\>[0]\AgdaFunction{+-comm}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSymbol{)}%
	\>[16]\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSymbol{)}%
	\>[25]\AgdaSymbol{=}\AgdaSpace{}%
	\AgdaFunction{cong}\AgdaSpace{}%
	\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaFunction{trans}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaFunction{+-suc}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaFunction{+-comm}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSymbol{))}\<%
	\\
	\>[0][@{}l@{\AgdaIndent{0}}]%
	\>[2]\AgdaKeyword{where}%
	\>[73I]\AgdaFunction{+-suc}\AgdaSpace{}%
	\AgdaSymbol{:}\AgdaSpace{}%
	\AgdaSymbol{∀}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSpace{}%
	\AgdaSymbol{→}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSpace{}%
	\AgdaOperator{\AgdaFunction{+}}\AgdaSpace{}%
	\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSpace{}%
	\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
	\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
	\AgdaOperator{\AgdaFunction{+}}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSymbol{)}\<%
	\\
	\>[.][@{}l@{}]\<[73I]%
	\>[8]\AgdaFunction{+-suc}\AgdaSpace{}%
	\AgdaInductiveConstructor{zero}%
	\>[23]\AgdaBound{n}\AgdaSpace{}%
	\AgdaSymbol{=}\AgdaSpace{}%
	\AgdaInductiveConstructor{refl}\<%
	\\
	%
	\>[8]\AgdaFunction{+-suc}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSymbol{)}%
	\>[23]\AgdaBound{n}\AgdaSpace{}%
	\AgdaSymbol{=}\AgdaSpace{}%
	\AgdaFunction{cong}\AgdaSpace{}%
	\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaFunction{+-suc}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSymbol{)}\<%
	\end{code}
\end{minipage}
	\vfill
	
	\visible<2->{\remark{Look at all the colors! \emoji{rainbow}}}
\end{frame}

{
\setbeamertemplate{background}{%
	\includegraphics[width=\paperwidth,height=\paperheight]{fractal_2.jpg}%
}
\begin{frame}{... what Agda really sees}
	\smaller
	\vspace{20.2em}
	\remark{\textit{(Artistically Interpreted)}}
\end{frame}
}


{
\setbeamertemplate{background}{%
  \tikz[remember picture, overlay]
    \shade[top color=gray!05, bottom color=gray!95]
      (current page.north west) rectangle (current page.south east);%
}
\begin{frame}{... what you show the LLM}
\smaller
{\scriptsize
\begin{minipage}{1.\textwidth}
	\token{open}
	\token{ import}
	\token{ Relation}
	\token{.Binary}
	\token{.Pro}
	\token{pos}
	\token{itional}
	\token{Equality}
	\token{ using}
	\token{ (_}
	\token{≡}
	\token{_;}
	\token{ refl}
	\token{;}
	\token{ cong}
	\token{;}
	\token{ trans}
	\token{)<newline><newline>}
	\token{data}
	\token{ }
	\token{ℕ}
	\token{ :}
	\token{ Set}
	\token{ where}
	\token{<newline>}
	\token{  }
	\token{ zero}
	\token{ :}
	\token{ }
	\token{ℕ}
	\token{<newline>}
	\token{  }
	\token{ suc}
	\token{ }
	\token{ :}
	\token{ }
	\token{ℕ}
	\token{ →}
	\token{ }
	\token{ℕ}
	\token{<newline><newline>}
	\token{_}
	\token{+}
	\token{_}
	\token{ :}
	\token{ }
	\token{ℕ}
	\token{ →}
	\token{ }
	\token{ℕ}
	\token{ →}
	\token{ }
	\token{ℕ}
	\token{<newline>}
	\token{zero}
	\token{ +}
	\token{ n}
	\token{ =}
	\token{ n}
	\token{<newline>}
	\token{s}
	\token{uc}
	\token{ m}
	\token{ +}
	\token{ n}
	\token{ =}
	\token{ suc}
	\token{ (}
	\token{m}
	\token{ +}
	\token{ n}
	\token{)<newline><newline>}
	\token{+-}
	\token{comm}
	\token{ :}
	\token{ (}
	\token{m}
	\token{ n}
	\token{ :}
	\token{ }
	\token{ℕ}
	\token{)}
	\token{ →}
	\token{ m}
	\token{ +}
	\token{ n}
	\token{ }
	\token{≡}
	\token{ n}
	\token{ +}
	\token{ m}
	\token{<newline>}
	\token{+-}
	\token{comm}
	\token{ zero}
	\token{ zero}
	\token{ =}
	\token{ refl}
	\token{<newline>}
	\token{+-}
	\token{comm}
	\token{ zero}
	\token{ (}
	\token{s}
	\token{uc}
	\token{ n}
	\token{)}
	\token{ =}
	\token{ cong}
	\token{ suc}
	\token{ (+}
	\token{-}
	\token{comm}
	\token{ zero}
	\token{ n}
	\token{)<newline>}
	\token{+-}
	\token{comm}
	\token{ (}
	\token{s}
	\token{uc}
	\token{ m}
	\token{)}
	\token{ zero}
	\token{ =}
	\token{ cong}
	\token{ suc}
	\token{ (+}
	\token{-}
	\token{comm}
	\token{ m}
	\token{ zero}
	\token{)<newline>}
	\token{+-}
	\token{comm}
	\token{ (}
	\token{s}
	\token{uc}
	\token{ m}
	\token{)}
	\token{ (}
	\token{s}
	\token{uc}
	\token{ n}
	\token{)}
	\token{ =}
	\token{ cong}
	\token{ suc}
	\token{ (}
	\token{trans}
	\token{ (+}
	\token{-}
	\token{s}
	\token{uc}
	\token{ m}
	\token{ n}
	\token{)}
	\token{ (+}
	\token{-}
	\token{comm}
	\token{ (}
	\token{s}
	\token{uc}
	\token{ m}
	\token{)}
	\token{ n}
	\token{))<newline>}
	\token{  }
	\token{ where}
	\token{ +-}
	\token{s}
	\token{uc}
	\token{ :}
	\token{ }
	\token{∀}
	\token{ m}
	\token{ n}
	\token{ →}
	\token{ m}
	\token{ +}
	\token{ suc}
	\token{ n}
	\token{ }
	\token{≡}
	\token{ suc}
	\token{ (}
	\token{m}
	\token{ +}
	\token{ n}
	\token{)<newline>}
	\token{        }
	\token{ +-}
	\token{s}
	\token{uc}
	\token{ zero}
	\token{ n}
	\token{ =}
	\token{ refl}
	\token{<newline>}
	\token{        }
	\token{ +-}
	\token{s}
	\token{uc}
	\token{ (}
	\token{s}
	\token{uc}
	\token{ m}
	\token{)}
	\token{ n}
	\token{ =}
	\token{ cong}
	\token{ suc}
	\token{ (+}
	\token{-}
	\token{s}
	\token{uc}
	\token{ m}
	\token{ n}
	\token{)}
\end{minipage}
}

\vspace{-4.5em}
\remark{Where did all the colors go? \emoji{cloud}}%
\end{frame}
}

\begin{frame}{... why LLMs then? \smaller (take \#1)}
	\smaller
	\begin{itemize}
		\item text as catch-all modality\\
			\light{an imperfect/irreversible projection of \textit{arbitrary} structure...}
		\uncover<2->{
		\item data scaling enables implicit learning\\
			\light{exposure to math, logic, code...}
		\uncover<3->{
		\item closest thing we have to general machine ``intellligence''\\
			\light{general intelligence subsumes (or at least aids) math problem solving}
		\uncover<4->{
		\item ease of integration\\
			\light{APIs everywhere... (plus: we write sequentially, too)}
		}}}
	\end{itemize}
\end{frame}

\begin{frame}{... why \alt<8->{(not) }{}LLMs then? \smaller (take \#2)}
	\smaller
	\alt<5-7,12->{
		\begin{center}
		\alt<6->{
			\alt<7->{
				\alt<12->{
					\hspace{1em}	
					\begin{minipage}{0.37\textwidth}
						\rotatebox{-2}{\fbox{\includegraphics[width=\textwidth]{contributions.png}}}
					\end{minipage}\hspace{1em}%
					\begin{minipage}{0.6\textwidth}
					\vspace{1em}%
					\rotatebox{4}{\fbox{\includegraphics[width=0.6\textwidth]{lean2.png}}}
					\end{minipage} 
				}{%
					\includegraphics[width=0.75\pagewidth]{lean.png}
				}
			}{%
				\includegraphics[width=0.45\pagewidth]{done_right.jpg}
			}
		}{%
			\includegraphics[width=0.45\pagewidth]{vibe.png}
		}
		\end{center}
	}{%
	\begin{itemize}
		\item technoscientific hype, AI zeitgeist\\
			\light{big tech is now into proof theory...}%
			\visible<8->{ \alert{$\rightsquigarrow$ concentration of technoscientific capital/authority}}
		\uncover<2->{
		\item low hanging fruit mentality\\
			\light{LLMs produce results \textit{today}}%
			\visible<9->{ \alert{$\rightsquigarrow$ what do we do \textit{tomorrow}?}}
		\uncover<3->{
		\item hard math made easy\\
			\light{LLM $\equiv$ universal calculator}%
			\visible<10->{ \alert{$\rightsquigarrow$ deskilling, less fundamental alignment between application \& theory}}
		\uncover<4->{
		\item benchmarking culture\\
			\light{less questions, more answers}%
			\visible<11->{ \alert{$\rightsquigarrow$ sales pitch aesthetics, knowledge recycling, science as competition, \dots}}
		}}}
	\end{itemize}
	}
\end{frame}


\begin{frame}{Doing things \st{right} better}
	\smaller
	Search for data efficient, structure-preserving alignment between domain (\textit{problem}) and architecture (\textit{tool}).
	
	\visible<2->{
	\vfill
	\textbf{Here:}
	\begin{itemize}[topsep=-0.25\baselineskip]
		\item \textit{Structured data extraction from Agda modules}.
		\item \textit{Learning to represent (the shapes of) the extracted types.}
	\end{itemize}
	}
\end{frame}

\begin{frame}{Data Extraction}
\smaller

\alt<16->{
	\visible<17->{
	\hspace{1.15cm}\begin{tikzpicture}[
			ast/.style={draw,gray,thick,outer sep=2pt,opacity=0.5},
			lab/.style={font=\large},
			ref/.style={->,dashed,gray,opacity=0.4,thick},
			var/.style={gray,opacity=0.8,execute at begin node={\strut(},execute at end node=)},
			t/.style={text height=1.5ex, text depth=.25ex, rectangle, outer sep=0pt},
			scale=1, transform shape]
		\tikzset{level 1/.style={level distance=22pt}, edge from parent/.append style={thick}}
		\Tree
		[.\node(t11) {•};
			[.\node{\$};
				[.\node{\$};
					\AgdaDatatype{≡}
					\AgdaBound{n}
				]
				[.\node{\$};
					[.\node{\$};
						\AgdaOperator{\AgdaFunction{+}}
						\AgdaBound{n}
					]
					\AgdaInductiveConstructor{zero}
				]
			]
		]
	\end{tikzpicture}}
}{%
\begin{minipage}{0.9\textwidth}
	\begin{code}%
	\uncover<-14,16->{\uncover<1,8->{\uncover<-4,8->{\uncover<-13,15->{%
	\>[0]\AgdaKeyword{open}\AgdaSpace{}%
	\AgdaKeyword{import}\AgdaSpace{}%
	\AgdaModule{Relation.Binary.PropositionalEquality}\AgdaSpace{}%
	\AgdaKeyword{using}\AgdaSpace{}%
	\AgdaSymbol{(}}\AgdaOperator{\AgdaDatatype{\AgdaUnderscore{}≡\AgdaUnderscore{}}}\uncover<-13,15->{\AgdaSymbol{;}}\AgdaSpace{}%
	\AgdaInductiveConstructor{refl}\uncover<-13,15->{\AgdaSymbol{;}}\AgdaSpace{}%
	\AgdaFunction{cong}\uncover<-13,15->{\AgdaSymbol{;}}\AgdaSpace{}%
	\AgdaFunction{trans}\uncover<-13,15->{\AgdaSymbol{)}\<%
	}}}}
	\end{code}
	
	\vspace{-1.25em}
	\begin{minipage}{.3\linewidth}
	\begin{code}%
	\uncover<-14,16->{\uncover<1,2,8->{\uncover<-4,8->{\uncover<-13,15->{%
	\>[0]%
	\AgdaKeyword{data}\AgdaSpace{}}%
	\AgdaDatatype{ℕ}\uncover<-13,15->{\AgdaSpace{}%
	\AgdaSymbol{:}\AgdaSpace{}%
	\AgdaPrimitive{Set}\AgdaSpace{}%
	\AgdaKeyword{where}\<%
	\\
	\>[0][@{}l@{\AgdaIndent{0}}]%
	\>[2]\AgdaInductiveConstructor{zero}%
	\>[8]\AgdaSymbol{:}\AgdaSpace{}%
	\AgdaDatatype{ℕ}\<%
	\\
	%
	\>[2]\AgdaInductiveConstructor{suc}%
	\>[8]\AgdaSymbol{:}\AgdaSpace{}%
	\AgdaDatatype{ℕ}\AgdaSpace{}%
	\AgdaSymbol{→}\AgdaSpace{}%
	\AgdaDatatype{ℕ}\<%
	}}}}
	\end{code}
	\end{minipage}
	
	\vspace{-1.25em}
	\begin{minipage}{.5\linewidth}
	\begin{code}%
	\>[0]\uncover<-14,16->{\uncover<1,3,5,8->{\AgdaOperator{\AgdaFunction{\AgdaUnderscore{}+\AgdaUnderscore{}}}}\AgdaSpace{}%
	\uncover<-13,15->{\uncover<1,3,8->{\AgdaSymbol{:}}\AgdaSpace{}%
	\uncover<1,3,6,8->{\AgdaDatatype{ℕ}\AgdaSpace{}%
	\AgdaSymbol{→}\AgdaSpace{}%
	\AgdaDatatype{ℕ}\AgdaSpace{}%
	\AgdaSymbol{→}\AgdaSpace{}%
	\AgdaDatatype{ℕ}}\<%
	\\
	\>[0]\uncover<1,3,7,8->{\AgdaInductiveConstructor{zero}%
	\>[7]\AgdaOperator{\AgdaFunction{+}}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSpace{}%
	\AgdaSymbol{=}\AgdaSpace{}%
	\AgdaBound{n}\<%
	\\
	\>[0]\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaBound{m}%
	\>[7]\AgdaOperator{\AgdaFunction{+}}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSpace{}%
	\AgdaSymbol{=}\AgdaSpace{}%
	\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
	\AgdaOperator{\AgdaFunction{+}}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSymbol{)}\<%
	}}}
	\end{code}
	\end{minipage}
	
	\vspace{-1.25em}
	\begin{code}%
	\uncover<1,4,8->{\uncover<-4,8->{%
	\>[0]\uncover<-14,16->{\AgdaFunction{+-comm}}\AgdaSpace{}%
	\uncover<-13,15->{\uncover<-14,16->{%
	\AgdaSymbol{:}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSpace{}%
	\AgdaSymbol{:}\AgdaSpace{}%
	\AgdaDatatype{ℕ}\AgdaSymbol{)}\AgdaSpace{}%
	\AgdaSymbol{→}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSpace{}%
	\AgdaOperator{\AgdaFunction{+}}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSpace{}%
	\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSpace{}%
	\AgdaOperator{\AgdaFunction{+}\AgdaSpace{}%
	\AgdaBound{m}}\<%
	\\
	\>[0]\AgdaFunction{+-comm}\AgdaSpace{}%
	\AgdaInductiveConstructor{zero}%
	\>[16]\AgdaInductiveConstructor{zero}%
	\>[25]\AgdaSymbol{=}\AgdaSpace{}%
	\hole{9}{\AgdaInductiveConstructor{refl}}\<
	\\
	\>[0]\AgdaFunction{+-comm}\AgdaSpace{}%
	\AgdaInductiveConstructor{zero}%
	\>[16]\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}}%
	\AgdaBound{n}\uncover<-14,16->{\AgdaSymbol{)}%
	\>[25]\AgdaSymbol{=}\AgdaSpace{}%
	}}%
	\uncover<-13,16->{\AgdaFunction{cong}\AgdaSpace{}%
	\AgdaInductiveConstructor{suc}}\AgdaSpace{}%
	\hole{12-16}{%
	\AgdaSymbol{(}\AgdaFunction{+-comm}\AgdaSpace{}%
	\hole{11}{\AgdaInductiveConstructor{zero}}\AgdaSpace{}%
	\hole{10}{\AgdaBound{n}}\AgdaSymbol{)}}\<%
	\\
	\uncover<-13,16->{%
	\>[0]\AgdaFunction{+-comm}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSymbol{)}%
	\>[16]\AgdaInductiveConstructor{zero}%
	\>[25]\AgdaSymbol{=}\AgdaSpace{}%
	\AgdaFunction{cong}\AgdaSpace{}%
	\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaFunction{+-comm}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSpace{}%
	\AgdaInductiveConstructor{zero}\AgdaSymbol{)}\<%
	\\
	\>[0]\AgdaFunction{+-comm}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSymbol{)}%
	\>[16]\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSymbol{)}%
	\>[25]\AgdaSymbol{=}\AgdaSpace{}%
	\AgdaFunction{cong}\AgdaSpace{}%
	\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaFunction{trans}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaFunction{+-suc}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSymbol{)}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaFunction{+-comm}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSymbol{))}\<%
	\\
	\>[0][@{}l@{\AgdaIndent{0}}]%
	\>[2]\AgdaKeyword{where}%
	\>[73I]\AgdaFunction{+-suc}\AgdaSpace{}%
	\AgdaSymbol{:}\AgdaSpace{}%
	\AgdaSymbol{∀}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSpace{}%
	\AgdaSymbol{→}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSpace{}%
	\AgdaOperator{\AgdaFunction{+}}\AgdaSpace{}%
	\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSpace{}%
	\AgdaOperator{\AgdaDatatype{≡}}\AgdaSpace{}%
	\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaBound{m}\AgdaSpace{}%
	\AgdaOperator{\AgdaFunction{+}}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSymbol{)}\<%
	\\
	\>[.][@{}l@{}]\<[73I]%
	\>[8]\AgdaFunction{+-suc}\AgdaSpace{}%
	\AgdaInductiveConstructor{zero}%
	\>[23]\AgdaBound{n}\AgdaSpace{}%
	\AgdaSymbol{=}\AgdaSpace{}%
	\AgdaInductiveConstructor{refl}\<%
	\\
	\>[8]\AgdaFunction{+-suc}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSymbol{)}%
	\>[23]\AgdaBound{n}\AgdaSpace{}%
	\AgdaSymbol{=}\AgdaSpace{}%
	\AgdaFunction{cong}\AgdaSpace{}%
	\AgdaInductiveConstructor{suc}\AgdaSpace{}%
	\AgdaSymbol{(}\AgdaFunction{+-suc}\AgdaSpace{}%
	\AgdaBound{m}\AgdaSpace{}%
	\AgdaBound{n}\AgdaSymbol{)}\<%
	}}}
	\end{code}
\end{minipage}
}\vfill

\begin{tikzpicture}[remember picture, overlay, shift={(current page.south west)}, shift={(1cm, 1cm)}]
	\visible<2>{
		\draw[rounded corners, thick, red] (0.7cm, 4.9cm) rectangle (3.6cm, 5.9cm);
    }
	\visible<3,5-7>{
		\draw[rounded corners, thick, red] (0.7cm, 3.6cm) rectangle (3.6cm, 4.7cm);
	}
	\visible<4>{
		\draw[rounded corners, thick, red] (0.7cm, 0.8cm) rectangle (9.5cm, 3.5cm);
	}

	\node[anchor=west, text width=7.5cm, text depth=0.25ex, text height=1.5ex] at (7.5cm, 5cm) {\alt<8->{%
		\alt<16->{%
			\begin{itemize}
			\item[3.] Each term \& type is recorded as both:\vspace{-0.3em}
				\begin{itemize}
					\item a pretty string
					\visible<17->{\item the underlying AST}
				\end{itemize}
			\end{itemize}
			
		}{%
			\begin{itemize}
				\item[2.] We go through all \textbf{subterms}.\\
				\visible<13-15>{For each subterm, we record:\vspace{-0.3em}
				\begin{itemize}
					\item its type \light{(/the goal)}
					\visible<14->{\item its scope}
					\visible<15->{\item its context}
				\end{itemize}
			}
			\end{itemize}
		}
    }{%
		\begin{itemize}
			\item[1.] We go through \textbf{all definitions}.\\
			\visible<5->{For each definition, we record:\vspace{-0.3em}
			\begin{itemize}
				\item its name
				\visible<6->{\item its type}
				\visible<7->{\item its term \light{(/proof)}}
			\end{itemize}
		}
		\end{itemize}
	}};

	\visible<13, 16->{
		\node[anchor=west, text width=7.5cm, text depth=0.25ex, text height=1.5ex] at (0.7cm, -0.2cm) {\texttt{\textcolor{red}{goal: n ≡ (n + zero)}}};
	}
\end{tikzpicture}
\end{frame}

\begin{frame}{Data: TL;DR}
	\smaller
	\textbf{Niceties}:
	\begin{itemize}
		\item among first ML datasets for Agda
		\item subterm iteration $\implies$ type-checked data augmentation for free
		\item extraction explicitly preserving term-structure (type \& proof level)
	\end{itemize}\vfill
	
	\visible<2->{
	\textbf{Numerical}\textsuperscript{1}:
	\begin{itemize}
		\item \eqmakebox[num][l]{800} modules
		\item \eqmakebox[n2][l]{\eqmakebox[num][l]{11.751} definitions}
		\item \eqmakebox[n2][l]{\eqmakebox[num][l]{67.255} ``holes'' \light{read: data points}}\\
		 \light{~(w/o subterm iteration: 6.960)}
	\end{itemize}\vfill

	\vspace{7em}
	\hrule\vspace{0.3em}
	\light{\smaller 1: for reference -- passing extracts from \texttt{agda-stdlib} 1.7.2}
	}
\end{frame}

\begin{frame}{Representation Learning \alt<6->{2}{1}\\
\smaller\light{\hphantom{xx} \alt<7->{Amending self-attention}{\alt<6->{How to represent it?}{What's to represent?}}}}
	\smaller
	\alt<6>{
		\textbf{Candidate Architectures}:
		\begin{itemize}
			\item \eqmakebox[architecture][l]{\st{LLMs}} \light{-\,- \textit{just no}}
			\item \eqmakebox[architecture][l]{\st{GNNs}} \light{-\,- \textit{too generic, oversmoothing}}
			\item \eqmakebox[architecture][l]{\st{Tree (R)NNs}} \light{-\,- \textit{too slow, generally under-performing}}
			\item \eqmakebox[architecture][l]{Full Attention [\light{?}]} \light{-\,- \textit{no structural biases}}\\
			\eqmakebox[architecture][l]{} \light{-\,- \textit{${\left(\sum_t^T n(t)\right)}^2$ scaling}}\\
		\end{itemize}\vfill
	}{
	\vspace{-4.5em}
	\centering\begin{tikzpicture}[
			ast/.style={draw,gray,thick,outer sep=2pt,opacity=0.5},
			lab/.style={font=\large},
			ref/.style={->,dashed,gray,opacity=0.45,thick, shorten >=4pt},
			prim/.style={},
			var/.style={gray,execute at begin node={\strut(},execute at end node=)},
			var2/.style={gray,execute at begin node={\strut(},execute at end node=)},
			var3/.style={gray},
			t/.style={text height=1.5ex, text depth=.25ex, rectangle, outer sep=0pt},
			atn/.style={gray!30,ultra thin,opacity=0.5},
			scale=0.65, transform shape]
		\only<2>{\tikzset{prim/.style={draw=red}}}
		\only<3>{\tikzset{var/.append style={draw=red}}}
		\only<4>{\tikzset{var2/.append style={draw=red}}}
		\only<5>{\tikzset{var3/.append style={draw=red}}}
		\tikzset{level 1/.style={level distance=22pt}, edge from parent/.append style={thick}}
		\begin{scope}[xshift=0cm]
		\Tree
		[.\node(t11) {•};
				\node[prim] (t12) {\AgdaPrimitive{Set}};
		]
		\alt<3>{
			\node[ast,draw=red,fit=(t11)(t12)](nat) {};
		}{
			\node[ast,fit=(t11)(t12)](nat) {};
		}
		\node[lab,xshift=5.5pt,yshift=4pt]() at(nat.north west) {\AgdaDatatype{ℕ}};
		\begin{scope}[xshift=3.75cm,yshift=-1.5cm]
		\Tree
		[.\node (t21) {•};
			[.\node[prim](t22) {$\to$} ;
				\node[var] (plus-l) {\AgdaDatatype{ℕ}};
				[.\node[prim](t23) {$\to$};
					\node[var] (plus-r) {\AgdaDatatype{ℕ}};
					\node[var] (plus-out) {\AgdaDatatype{ℕ}};
				]
			]
		]
		\alt<4>{
			\node[ast,draw=red,fit=(t21)(plus-l)(plus-out)] (+) {};
		}{
			\node[ast,fit=(t21)(plus-l)(plus-out)] (+) {};
		}
		\node[lab,xshift=4.5pt,yshift=4pt]() at(+.north west) {\AgdaFunction{+}};
		\begin{scope}[xshift=6.5cm,yshift=3.2cm]\Tree
		[.\node (t31) {•};
			[.\node[prim](t32) {$\Pi$};
				\node[var,var3] (m-def) {$\AgdaBound{m}:\AgdaPrimitive{ℕ}$};
				[.\node[prim](t33) {$\Pi$};
					\node[var,var3] (n-def) {$\AgdaBound{n}:\AgdaPrimitive{ℕ}$};
					[.\node[prim](t34) {\$};
						[.\node[prim](t35){\$};
							\node[prim](t36){\AgdaPrimitive{≡}};
							[.\node[prim](t37){\$};
								[.\node[prim](t38){\$};
									\node[var2] (+-ref-1) {\AgdaFunction{+}};
									\node[var3] (m-ref-1) {\AgdaBound{m}};
								]
								\node[var3] (n-ref-1) {\AgdaBound{n}};
							]
						]
						[.\node[prim](t39){\$};
							[.\node[prim](t310){\$};
								\node[var2] (+-ref-2) {\AgdaFunction{+}};
								\node[var3] (n-ref-2) {\AgdaBound{n}};
							]
							\node[var3] (m-ref-2) {\AgdaBound{m}};
						]
					]
				]
			]
		]
		\node[ast,fit=(t31)(m-def)(+-ref-1)(m-ref-2)] (comm) {};
		\node[lab,xshift=19pt,yshift=4pt]() at(comm.north west) {\AgdaFunction{+-comm}};
		\end{scope}\end{scope}\end{scope}
		\visible<3-6,11,14>{
			\draw[ref,var] (plus-l) -- (nat);
			\draw[ref,var] (plus-r) -- (nat);
			\draw[ref,var] (plus-out) -- (nat);
		}
		\visible<3-6,12,14>{
			\draw[ref,var] (m-def) -- (nat);
			\draw[ref,var] (n-def) -- (nat);
		}
		\visible<4-6,12,14>{
			\draw[ref,var2] (+-ref-1) -- (+);
			\draw[ref,var2] (+-ref-2) -- (+);
		}
		\visible<5-6,13->{
			\draw[ref,var3] (m-ref-1) -- (m-def);
			\draw[ref,var3] (m-ref-2) -- (m-def);
			\draw[ref,var3] (n-ref-1) -- (n-def);
			\draw[ref,var3] (n-ref-2) -- (n-def);
		}
		\visible<7-9>{
			\draw[atn] (t11) -- (t12);
			\visible<7>{
			\draw[atn] (t11) -- (t21);
			\draw[atn] (t11) -- (t22);
			\draw[atn] (t11) -- (t23);
			\draw[atn] (t11) -- (plus-l);
			\draw[atn] (t11) -- (plus-r);
			\draw[atn] (t11) -- (plus-out);
			\draw[atn] (t11) -- (t31);
			\draw[atn] (t11) -- (t32);
			\draw[atn] (t11) -- (t33);
			\draw[atn] (t11) -- (t34);
			\draw[atn] (t11) -- (t35);
			\draw[atn] (t11) -- (t36);
			\draw[atn] (t11) -- (t37);
			\draw[atn] (t11) -- (t38);
			\draw[atn] (t11) -- (t39);
			\draw[atn] (t11) -- (t310);
			\draw[atn] (t11) -- (m-def);
			\draw[atn] (t11) -- (m-ref-1);
			\draw[atn] (t11) -- (m-ref-2);
			\draw[atn] (t11) -- (n-def);
			\draw[atn] (t11) -- (n-ref-1);
			\draw[atn] (t11) -- (n-ref-2);
			}
			
			\visible<7>{
			\draw[atn] (t12) -- (t21);
			\draw[atn] (t12) -- (t22);
			\draw[atn] (t12) -- (t23);
			\draw[atn] (t12) -- (plus-l);
			\draw[atn] (t12) -- (plus-r);
			\draw[atn] (t12) -- (plus-out);
			\draw[atn] (t12) -- (t31);
			\draw[atn] (t12) -- (t32);
			\draw[atn] (t12) -- (t33);
			\draw[atn] (t12) -- (t34);
			\draw[atn] (t12) -- (t35);
			\draw[atn] (t12) -- (t36);
			\draw[atn] (t12) -- (t37);
			\draw[atn] (t12) -- (t38);
			\draw[atn] (t12) -- (t39);
			\draw[atn] (t12) -- (t310);
			\draw[atn] (t12) -- (m-def);
			\draw[atn] (t12) -- (m-ref-1);
			\draw[atn] (t12) -- (m-ref-2);
			\draw[atn] (t12) -- (n-def);
			\draw[atn] (t12) -- (n-ref-1);
			\draw[atn] (t12) -- (n-ref-2);
			}
			
			\draw[atn] (t21) -- (t22);
			\draw[atn] (t21) -- (t23);
			\draw[atn] (t21) -- (plus-l);
			\draw[atn] (t21) -- (plus-r);
			\draw[atn] (t21) -- (plus-out);
			\visible<7>{
			\draw[atn] (t21) -- (t31);
			\draw[atn] (t21) -- (t32);
			\draw[atn] (t21) -- (t33);
			\draw[atn] (t21) -- (t34);
			\draw[atn] (t21) -- (t35);
			\draw[atn] (t21) -- (t36);
			\draw[atn] (t21) -- (t37);
			\draw[atn] (t21) -- (t38);
			\draw[atn] (t21) -- (t39);
			\draw[atn] (t21) -- (t310);
			\draw[atn] (t21) -- (m-def);
			\draw[atn] (t21) -- (m-ref-1);
			\draw[atn] (t21) -- (m-ref-2);
			\draw[atn] (t21) -- (n-def);
			\draw[atn] (t21) -- (n-ref-1);
			\draw[atn] (t21) -- (n-ref-2);
			}
			
			\draw[atn] (t22) -- (t23);
			\draw[atn] (t22) -- (plus-l);
			\draw[atn] (t22) -- (plus-r);
			\draw[atn] (t22) -- (plus-out);
			\visible<7>{
			\draw[atn] (t22) -- (t31);
			\draw[atn] (t22) -- (t32);
			\draw[atn] (t22) -- (t33);
			\draw[atn] (t22) -- (t34);
			\draw[atn] (t22) -- (t35);
			\draw[atn] (t22) -- (t36);
			\draw[atn] (t22) -- (t37);
			\draw[atn] (t22) -- (t38);
			\draw[atn] (t22) -- (t39);
			\draw[atn] (t22) -- (t310);
			\draw[atn] (t22) -- (m-def);
			\draw[atn] (t22) -- (m-ref-1);
			\draw[atn] (t22) -- (m-ref-2);
			\draw[atn] (t22) -- (n-def);
			\draw[atn] (t22) -- (n-ref-1);
			\draw[atn] (t22) -- (n-ref-2);
			}

			\draw[atn] (t23) -- (plus-l);
			\draw[atn] (t23) -- (plus-r);
			\draw[atn] (t23) -- (plus-out);
			\visible<7>{
			\draw[atn] (t23) -- (t31);
			\draw[atn] (t23) -- (t32);
			\draw[atn] (t23) -- (t33);
			\draw[atn] (t23) -- (t34);
			\draw[atn] (t23) -- (t35);
			\draw[atn] (t23) -- (t36);
			\draw[atn] (t23) -- (t37);
			\draw[atn] (t23) -- (t38);
			\draw[atn] (t23) -- (t39);
			\draw[atn] (t23) -- (t310);
			\draw[atn] (t23) -- (m-def);
			\draw[atn] (t23) -- (m-ref-1);
			\draw[atn] (t23) -- (m-ref-2);
			\draw[atn] (t23) -- (n-def);
			\draw[atn] (t23) -- (n-ref-1);
			\draw[atn] (t23) -- (n-ref-2);
			}

			\draw[atn] (plus-l) -- (plus-r);
			\draw[atn] (plus-l) -- (plus-out);
			\visible<7>{
			\draw[atn] (plus-l) -- (t31);
			\draw[atn] (plus-l) -- (t32);
			\draw[atn] (plus-l) -- (t33);
			\draw[atn] (plus-l) -- (t34);
			\draw[atn] (plus-l) -- (t35);
			\draw[atn] (plus-l) -- (t36);
			\draw[atn] (plus-l) -- (t37);
			\draw[atn] (plus-l) -- (t38);
			\draw[atn] (plus-l) -- (t39);
			\draw[atn] (plus-l) -- (t310);
			\draw[atn] (plus-l) -- (m-def);
			\draw[atn] (plus-l) -- (m-ref-1);
			\draw[atn] (plus-l) -- (m-ref-2);
			\draw[atn] (plus-l) -- (n-def);
			\draw[atn] (plus-l) -- (n-ref-1);
			\draw[atn] (plus-l) -- (n-ref-2);
			}
			
			\draw[atn] (plus-r) -- (plus-out);
			\visible<7>{
			\draw[atn] (plus-r) -- (t31);
			\draw[atn] (plus-r) -- (t32);
			\draw[atn] (plus-r) -- (t33);
			\draw[atn] (plus-r) -- (t34);
			\draw[atn] (plus-r) -- (t35);
			\draw[atn] (plus-r) -- (t36);
			\draw[atn] (plus-r) -- (t37);
			\draw[atn] (plus-r) -- (t38);
			\draw[atn] (plus-r) -- (t39);
			\draw[atn] (plus-r) -- (t310);
			\draw[atn] (plus-r) -- (m-def);
			\draw[atn] (plus-r) -- (m-ref-1);
			\draw[atn] (plus-r) -- (m-ref-2);
			\draw[atn] (plus-r) -- (n-def);
			\draw[atn] (plus-r) -- (n-ref-1);
			\draw[atn] (plus-r) -- (n-ref-2);
			}
			
			\visible<7>{
			\draw[atn] (plus-out) -- (t31);
			\draw[atn] (plus-out) -- (t32);
			\draw[atn] (plus-out) -- (t33);
			\draw[atn] (plus-out) -- (t34);
			\draw[atn] (plus-out) -- (t35);
			\draw[atn] (plus-out) -- (t36);
			\draw[atn] (plus-out) -- (t37);
			\draw[atn] (plus-out) -- (t38);
			\draw[atn] (plus-out) -- (t39);
			\draw[atn] (plus-out) -- (t310);
			\draw[atn] (plus-out) -- (m-def);
			\draw[atn] (plus-out) -- (m-ref-1);
			\draw[atn] (plus-out) -- (m-ref-2);
			\draw[atn] (plus-out) -- (n-def);
			\draw[atn] (plus-out) -- (n-ref-1);
			\draw[atn] (plus-out) -- (n-ref-2);
			}
			
			\draw[atn] (t31) -- (t32);
			\draw[atn] (t31) -- (t33);
			\draw[atn] (t31) -- (t34);
			\draw[atn] (t31) -- (t35);
			\draw[atn] (t31) -- (t36);
			\draw[atn] (t31) -- (t37);
			\draw[atn] (t31) -- (t38);
			\draw[atn] (t31) -- (t39);
			\draw[atn] (t31) -- (t310);
			\draw[atn] (t31) -- (m-def);
			\draw[atn] (t31) -- (m-ref-1);
			\draw[atn] (t31) -- (m-ref-2);
			\draw[atn] (t31) -- (n-def);
			\draw[atn] (t31) -- (n-ref-1);
			\draw[atn] (t31) -- (n-ref-2);
			
			\draw[atn] (t32) -- (t33);
			\draw[atn] (t32) -- (t34);
			\draw[atn] (t32) -- (t35);
			\draw[atn] (t32) -- (t36);
			\draw[atn] (t32) -- (t37);
			\draw[atn] (t32) -- (t38);
			\draw[atn] (t32) -- (t39);
			\draw[atn] (t32) -- (t310);
			\draw[atn] (t32) -- (m-def);
			\draw[atn] (t32) -- (m-ref-1);
			\draw[atn] (t32) -- (m-ref-2);
			\draw[atn] (t32) -- (n-def);
			\draw[atn] (t32) -- (n-ref-1);
			\draw[atn] (t32) -- (n-ref-2);
			
			\draw[atn] (t33) -- (t34);
			\draw[atn] (t33) -- (t35);
			\draw[atn] (t33) -- (t36);
			\draw[atn] (t33) -- (t37);
			\draw[atn] (t33) -- (t38);
			\draw[atn] (t33) -- (t39);
			\draw[atn] (t33) -- (t310);
			\draw[atn] (t33) -- (m-def);
			\draw[atn] (t33) -- (m-ref-1);
			\draw[atn] (t33) -- (m-ref-2);
			\draw[atn] (t33) -- (n-def);
			\draw[atn] (t33) -- (n-ref-1);
			\draw[atn] (t33) -- (n-ref-2);

			\draw[atn] (t34) -- (t35);
			\draw[atn] (t34) -- (t36);
			\draw[atn] (t34) -- (t37);
			\draw[atn] (t34) -- (t38);
			\draw[atn] (t34) -- (t39);
			\draw[atn] (t34) -- (t310);
			\draw[atn] (t34) -- (m-def);
			\draw[atn] (t34) -- (m-ref-1);
			\draw[atn] (t34) -- (m-ref-2);
			\draw[atn] (t34) -- (n-def);
			\draw[atn] (t34) -- (n-ref-1);
			\draw[atn] (t34) -- (n-ref-2);

			\draw[atn] (t35) -- (t36);
			\draw[atn] (t35) -- (t37);
			\draw[atn] (t35) -- (t38);
			\draw[atn] (t35) -- (t39);
			\draw[atn] (t35) -- (t310);
			\draw[atn] (t35) -- (m-def);
			\draw[atn] (t35) -- (m-ref-1);
			\draw[atn] (t35) -- (m-ref-2);
			\draw[atn] (t35) -- (n-def);
			\draw[atn] (t35) -- (n-ref-1);
			\draw[atn] (t35) -- (n-ref-2);

			\draw[atn] (t36) -- (t37);
			\draw[atn] (t36) -- (t38);
			\draw[atn] (t36) -- (t39);
			\draw[atn] (t36) -- (t310);
			\draw[atn] (t36) -- (m-def);
			\draw[atn] (t36) -- (m-ref-1);
			\draw[atn] (t36) -- (m-ref-2);
			\draw[atn] (t36) -- (n-def);
			\draw[atn] (t36) -- (n-ref-1);
			\draw[atn] (t36) -- (n-ref-2);
			
			\draw[atn] (t37) -- (t38);
			\draw[atn] (t37) -- (t39);
			\draw[atn] (t37) -- (t310);
			\draw[atn] (t37) -- (m-def);
			\draw[atn] (t37) -- (m-ref-1);
			\draw[atn] (t37) -- (m-ref-2);
			\draw[atn] (t37) -- (n-def);
			\draw[atn] (t37) -- (n-ref-1);
			\draw[atn] (t37) -- (n-ref-2);
			
			\draw[atn] (t38) -- (t39);
			\draw[atn] (t38) -- (t310);
			\draw[atn] (t38) -- (m-def);
			\draw[atn] (t38) -- (m-ref-1);
			\draw[atn] (t38) -- (m-ref-2);
			\draw[atn] (t38) -- (n-def);
			\draw[atn] (t38) -- (n-ref-1);
			\draw[atn] (t38) -- (n-ref-2);
			
			\draw[atn] (t39) -- (t310);
			\draw[atn] (t39) -- (m-def);
			\draw[atn] (t39) -- (m-ref-1);
			\draw[atn] (t39) -- (m-ref-2);
			\draw[atn] (t39) -- (n-def);
			\draw[atn] (t39) -- (n-ref-1);
			\draw[atn] (t39) -- (n-ref-2);

			\draw[atn] (t310) -- (m-def);
			\draw[atn] (t310) -- (m-ref-1);
			\draw[atn] (t310) -- (m-ref-2);
			\draw[atn] (t310) -- (n-def);
			\draw[atn] (t310) -- (n-ref-1);
			\draw[atn] (t310) -- (n-ref-2);

			\draw[atn] (m-def) -- (m-ref-1);
			\draw[atn] (m-def) -- (m-ref-2);
			\draw[atn] (m-def) -- (n-def);
			\draw[atn] (m-def) -- (n-ref-1);
			\draw[atn] (m-def) -- (n-ref-2);

			\draw[atn] (m-ref-1) -- (m-ref-2);
			\draw[atn] (m-ref-1) -- (n-def);
			\draw[atn] (m-ref-1) -- (n-ref-1);
			\draw[atn] (m-ref-1) -- (n-ref-2);

			\draw[atn] (m-ref-2) -- (n-def);
			\draw[atn] (m-ref-2) -- (n-ref-1);
			\draw[atn] (m-ref-2) -- (n-ref-2);
			
			\draw[atn] (n-def) -- (n-ref-1);
			\draw[atn] (n-def) -- (n-ref-2);
			
			\draw[atn] (n-ref-1) -- (n-ref-2);
		}
	\end{tikzpicture}
	
	\visible<-6>{
	\begin{tikzpicture}[remember picture, overlay, shift={(current page.south west)}]
		\node[anchor=west, text width=10.5cm, text depth=0.25ex, text height=1.5ex] at (0.75cm, 2cm) {
			\alt<2->{A sequence of ASTs, where nodes are:}{A sequence of ASTs}
				\begin{itemize}
					\visible<2->{\item \eqmakebox[things][l]{primitive symbols} \light{-\,- Set, $\Pi$, $\to$, $\lambda$, \$, \dots}}
					\visible<3->{\item \eqmakebox[things][l]{references to (other) lemmas (inter-AST)} \light{-\,- $\mathbb{N}$, $+$, \dots}}
					\visible<5->{\item \eqmakebox[things][l]{references to bound variables (intra-AST)} \light{-\,- $m$, $n$, \dots}}
				\end{itemize}
		};
	\end{tikzpicture}
	}
	
	\visible<7->{
		\visible<10-12>{
			\begin{tikzpicture}[remember picture, overlay, shift={(current page.south west)}]
				\draw[red, thick] plot [smooth cycle, tension=0.9] coordinates {(2.9,5.5) (4, 5.5) (4, 6.9) (2.9, 6.9)};
				\draw[red, thick] plot [smooth cycle, tension=0.9] coordinates {(2.88,5.57) (4.05, 5.48) (3.99, 6.9) (2.9, 6.95)};
				\node (1) at (3.9, 6.75) {\Large\textcolor{red}{0}};
				\visible<11->{
					\draw[red, thick] plot [smooth cycle, tension=1] coordinates {(5, 3.1) (7, 3.1) (7,5.9) (5, 5.9)};
					\draw[red, thick] plot [smooth cycle, tension=1] coordinates {(4.95, 3.1) (6.95, 3.05) (7.05,5.9) (5, 5.85)};
					\node (2) at (6.6, 5.85) {\Large\textcolor{red}{1}};
				}
				\visible<12->{
					\draw[red, thick] plot [smooth cycle, tension=0.8] coordinates {(8.5, 2.8) (13.5, 2.8) (13.2, 7.5) (8.5, 7.8)};
					\draw[red, thick] plot [smooth cycle, tension=0.8] coordinates {(8.55, 2.75) (13.45, 2.85) (13.2, 7.5) (8.5, 7.85)};
					\node (3) at (12, 7.85) {\Large\textcolor{red}{2}};
				}
			\end{tikzpicture}
		}
		\begin{tikzpicture}[remember picture, overlay, shift={(current page.south west)}]
			\node[anchor=west, text width=12.5cm, text depth=0.25ex, text height=1.5ex] at (0.75cm, 2.3cm) {
				\alt<14->{Representations informed by \textbf{type shapes} alone:
					\begin{itemize}
						\item invariance to $\alpha$-renaming, scope permutations, syntactic distractions, etc.
						\item \light{\dots but a few things get lost in translation}
					\end{itemize}
				}{
				\begin{itemize}
					\visible<8->{
					\item \eqmakebox[improvement][l]{Per-Tree Attention} \light{-\,- $\sum_t^T n(t)^2$ scaling}
					}
					\visible<9->{\\
					\eqmakebox[improvement][l]{} \light{-\,- $\sum_t^T n(t)$ if using a linear kernel (here: Taylor series)}
					}
					\visible<10->{\item \eqmakebox[improvement][l]{Dependency-Level Batching} \light{-\,- explicit scope referencing}}
					\visible<13->{\item \eqmakebox[improvement][l]{Relative Tree-PE} \light{-\,- proper inductive biases}\\
					\visible<14->{\eqmakebox[improvement][l]{} \light {-\,- \& dynamic variable indexing}}
					}
				\end{itemize}
				}
			};
		\end{tikzpicture}
	}
}
\end{frame}

\begin{frame}{Experimental Setup}
	\smaller
	\textbf{Premise Selection}\\
	Contextually rank scope entries by their relevance to the current goal.\vfill
	
		\textbf{\agdaQuill} \emoji{feather}\\
	Tiny PoC model (\light{6L $\times$ 8H $\times$ 256D; 1 mil. params; 25MB@FP32}) trained for $\sim$8h on a single V100\vfill
	
	\textbf{Data}
	\begin{itemize}
		\item train on random holes from 85\% of \texttt{agda-stdlib} (ignoring size outliers)
		\item eval on unseen proofs from:\vspace{-0.15em}
		\begin{itemize}
			\item remaining 15\% (split between \textsc{id} and \textsc{ood} on the basis of size)
			\item \texttt{Unimath} \& \texttt{TypeTopology} (distant domains)
		\end{itemize}
	\end{itemize}
\end{frame}

\begin{frame}{... but does it work?}
	\smaller
	\alt<2->{
		\alt<3->{
			\vspace{2.5em}
		\textbf{Findings, TL;DR}
		\begin{itemize}
			\item high performance despite limited expressivity \& no term exposition
			\item structure preservation outweights architectural optimizations
			\item baseline encoder collapses
		\end{itemize}
		}{
		\textbf{Less obscure visualization}
	
		\begin{center}
			\includegraphics[width=0.65\textwidth, trim={0 3em 0 4em}, clip]{violin.pdf}
		\end{center}
		\light{Empirical distribution of selection scores of relevant (green) vs irrelevant (red) lemmas (\stdlib{}:\textsc{id}).}
		}
	}{
	\vspace{2.5em}
	\textbf{Mandatory table with numbers}
	\begin{center}\vspace{-0.5em}
	\newcolumntype{C}{>{\centering\arraybackslash}X}
	\newcolumntype{L}{>{\raggedright\arraybackslash}X}
	\newcolumntype{R}{>{\raggedleft\arraybackslash}X}
	\begin{tabularx}{0.8\textwidth}{
		@{}l@{\quad}L@{~/~}R@{\quad}R@{~/~}L@{\quad}R@{~/~}L@{\quad}R@{~/~}L@{}
	}
	& \multicolumn{8}{c}{Average / R-Precision}\\
	\cmidrule{2-9}
	\multicolumn{1}{@{}l}{\textsc{Model}}
	& \multicolumn{2}{@{\quad}C@{\quad}}{\stdlib{}:\textsc{id}}
	& \multicolumn{2}{C@{\quad}}{\stdlib{}:\textsc{ood}}
	& \multicolumn{2}{@{\quad}C@{\quad}}{\unimath}
	& \multicolumn{2}{@{\quad}C@{\quad}}{\typetopo}\\
	\toprule
	~\agdaQuill 	&
		\bfstat{50.2}{0.5} & \bfstat{40.3}{0.4} & \bfstat{38.7}{0.7} & \bfstat{31.1}{0.9} & \bfstat{27.0}{0.4} & \bfstat{17.4}{0.3} & \bfstat{22.5}{0.3} & \bfstat{15.4}{0.5} \\
	~~ (no Taylor expansion)		& \bstat{47.0}{0.4} & \bstat{36.2}{0.5} & \bstat{37.1}{0.5} & \bstat{29.2}{0.6} & \bstat{26.8}{0.2} & \bstat{17.0}{0.1} & \bstat{21.4}{0.5} & \bstat{14.4}{0.4} \\
	~~ (no Tree-PE)	 & \bstat{44.5}{1.5} & \bstat{34.1}{1.8} & \bstat{30.7}{0.4} & \bstat{24.0}{0.4} & \bstat{24.8}{3.4} & \bstat{15.5}{2.9} & \bstat{18.8}{1.1} & \bstat{12.3}{0.9}\\
	~~ (no variable resolution)	& \bstat{35.8}{2.7} & \bstat{25.9}{2.7} & \bstat{25.5}{2.7} & \bstat{19.1}{2.4} & \bstat{19.7}{1.8} & \bstat{11.6}{1.5} & \bstat{17.7}{3.0} & \bstat{11.0}{3.1}\\	
		~Transformer Baseline & \bstat{10.9}{0.4} & \sstat{3.7}{0.2} & \sstat{8.5}{0.2	} & \sstat{4.5}{0.1} & \sstat{9.4}{0.3} & \sstat{3.9}{0.1} & \sstat{5.8}{0.0} & \sstat{0.9}{0.0} \\
	\bottomrule	
	\end{tabularx}
	\end{center}\vfill
	}
\end{frame}

\begin{frame}{Suggested takehome messages}
	\smaller
	\vspace{3em}
	\begin{itemize}
		\item[\emoji{earth-africa}] the earth is not flat, proofs are not strings, LLMs are not the (only) answer
		\item[\emoji{key}] back-and-forth compiler integration is the key to better architectures
	\end{itemize}\vfill
	
	\hfill Thank you\vfill	
	
	\begin{itemize}
		\item \eqmakebox[names][l]{\textsc{Paper}}  -- \href{https://openreview.net/forum?id=e397soEZh8}{openreview.net/forum?id=e397soEZh8}\\
		\light{\textit{Published manuscript \& reviews.}}
		\item \eqmakebox[names][l]{\textsc{Agda2Train}} -- \href{https://github.com/omelkonian/agda2train}{github.com/omelkonian/agda2train}\\
		\light{\textit{Data extraction as an Agda \textit{compilation backend} (in Haskell).}}
		\item \eqmakebox[names][l]{\textsc{Agda-Quill}} -- \href{https://github.com/konstantinosKokos/quill}{github.com/konstantinoskokos/quill}\\
		\light{\textit{ML model; ML-facing Python interface for dataset reading \& processing.}}
	\end{itemize}\vfill
\end{frame}

\begin{frame}[plain]
	\includegraphics[width=\textwidth]{interface.png}
\end{frame}

\end{document}
